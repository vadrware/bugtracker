{% extends "base.html" %}

{% load comments %}

{% block section %}Defects{% endblock %}
{% block title %}Defect Detail: #{{ object.pk }}{% endblock %}

{% block content %}

	<p class="title">Defect Detail: #{{ object.pk }}</p>
	<div class="view">
        <div class="view_container" name="objectView" id="objectView">
  
            <fieldset>
                <legend class="primary first">Defect Information</legend>
			    <ul>
                    <li><label>Defect Number:</label><span>{{ object.pk }}</span><div class="vd" /></li>
                    <li><label>Reproduction Steps:</label><span>{{ object.reproduce }}</span><div class="vd" /></li>
                    <li><label>Created By:</label><span>{{ object.userid }}</span><div class="vd" /></li>
                    <li><label>Post Date:</label><span>{{ object.postdate }}</span><div class="vd" /></li>
                    <li><label>Modified Date:</label><span>{{ object.moddate }}</span></li>
		        </ul>
	        </fieldset> 	

            <fieldset>
                <legend class="primary">Status</legend>
			    <ul>
                    <li><label>Defect State:</label><span>{{ object.get_defectstate_display }}</span><div class="vd" /></li>
                    <li><label>Resolution:</label><span>{{ object.resolutionid }}</span></li>
		        </ul>
	        </fieldset> 

            <fieldset>
                <legend class="primary">Affected Product</legend>
			    <ul>
                    <li><label>Product Name:</label><span>{{ object.productid }}</span><div class="vd" /></li>
                    <li><label>Product Version:</label><span>{{ object.projectversion }}</span></li>
		        </ul>
	        </fieldset>
	        
            <div class="actions">
                <p class="action-links">
                    <a href="../create">Create Defect</a> | <a href="../update/{{ object.pk }}">Update Defect</a> | <a href="..">List Defects</a>
                </p>
            </div>

    	</div>
	</div>

    {% get_comment_count for object as comment_count %}
    {% get_comment_list for object as comment_list %}

	<div class="view" style="margin-top:20px">
        <div class="view_container" name="objectView" id="objectView">
            <fieldset>
                <legend class="primary first">Comments ({{ comment_count }})</legend>

                {% for comment in comment_list %}
			    <ul>
                    <li><label>Comment #{{ forloop.counter }}:</label>
                        <span class="text_area">{{ comment.user_name|escape }} on {{ comment.submit_date|date:"F j, Y" }} at {{ comment.submit_date|date:"P" }} writes: 
                        <p style="margin-top:10px">{{ comment.comment|escape|urlizetrunc:"40"|linebreaks }}</p></span>
                        {% ifnotequal forloop.counter comment_count %}
                            <div class="vd" />
                        {% endifnotequal %}
                    </li>
		        </ul>
                {% endfor %}

            </fieldset>
            <div class="actions">
                <p class="action-links">
                </p>
            </div>
        </div>
    </div>

    <div class='styled' style="margin-top:20px">
    {% render_comment_form for object %}
    </div>

{% endblock %}
